<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>{{ $.Site.Title }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {{ hugo.Generator }}
    <link rel="icon" href="{{ .Site.Params.favicon | absURL }}" type="image/x-icon">
    {{ $style := resources.Get "presidium.scss" | resources.ToCSS | resources.Minify | resources.Fingerprint }}
    <link rel="stylesheet" href="{{ $style.RelPermalink }}">
    {{ if resources.Get "index.scss" }}
    {{ with resources.Get "index.scss" | resources.ToCSS | resources.Minify | resources.Fingerprint }}
    <link rel="stylesheet" href="{{ .RelPermalink }}">
    {{ end }}
    {{ end }}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.js"></script>
</head>

<body id="presidium">
    {{ if $.Site.Params.enterprise_enabled }}
      <div class="toolbar-wrapper">
        <div data-key="{{ $.Site.Params.enterprise_key }}" data-title="{{ $.Site.Title }}" id="presidium-enterprise"
        class="presidium-enterprise"></div>
      </div>
    {{ end }}

    <div class="content-wrapper">
      <div id="presidium-navigation">
        {{ partial "navigation.html" .}}
      </div>
  
      <div id="resizer"></div>
      <div id="presidium-container" class="container-fluid">
          <div class="row">
              <div id="presidium-content" class="col-lg-10 col-md-12">
                  <h1 class="page-title">{{ .Title }}</h1>
                  <hr />
  
                  <section>
                      {{ partial "info.html" }}
                      {{ block "content" . }}
                      {{ end }}
                  </section>
                  {{ partial "footer.html" . }}
              </div>
              <div class="col-lg-2"></div>
          </div>
      </div>
    </div>
 
    <!--presidium-container-->

    {{ partial "modal.html" }}

    <script>
        $(document).ready(function () {
            $('.menu-expander').click(function (event) {
                event.preventDefault();
                if (this.firstElementChild) {
                    this.firstElementChild.classList.toggle('glyphicon-chevron-down');
                    this.firstElementChild.classList.toggle('glyphicon-chevron-right');
                }
                $(this).parent().closest('.menu-row').toggleClass('open').toggleClass('closed');
            });

            $('.toggle').click(function (event) {
                event.preventDefault();
                $('.navbar-items').toggle('expanded');
            });

        });
    </script>

    <!-- Components -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script src="/presidium.js"></script>
    <script>
        window.presidium.tooltips.load();
        window.presidium.modal.init();

        mermaid.initialize({ startOnLoad: true });
    </script>

    {{ if $.Site.Params.enterprise_enabled }}
    <script src="{{ $.Site.Params.enterprise_script }}"></script>
    <script>
        const toolbarHeight = $("#presidium-enterprise").height()
        if(toolbarHeight) {
          $("#presidium-navigation").css({ top: `${toolbarHeight}px` });
        }
    </script>
    {{ end }}

    {{ if $.Site.Params.analyticsToken }}
         {{ partial "analytics.html"  . }}
    {{ end }}
    
    {{ if $.Site.Params.resizeMenu | default true }}
    <script>
        const desktopSize = window.matchMedia("(min-width: 768px)")
        const resizer = document.querySelector("#resizer");
        const sidebar = document.querySelector("#presidium-navigation");

        if(desktopSize.matches) {
          resizer.style.display = 'block';
        }

        const cachedSize = window.localStorage.getItem('sidenav');
        if(cachedSize && desktopSize.matches) {
          sidebar.style.flexBasis = cachedSize;
        }
        
        resizer.addEventListener("mousedown", (event) => {
          event.preventDefault();
          document.addEventListener("mousemove", resize, false);
          document.addEventListener("mouseup", () => {
            event.preventDefault();
            document.removeEventListener("mousemove", resize, false);
          }, false);
        });
        
        function resize(e) {
          const size = `${e.x}px`;
          window.localStorage.setItem('sidenav', size);
          sidebar.style.flexBasis = size;
        }
    </script>
    {{ end }}
    
    {{ if $.Site.Params.enableSublinks }}
    <script type="application/javascript">

      (function addHeadingLinks(){
        var articles = document.querySelectorAll('.article.child');

        articles.forEach( function(article){
          var headings = article.querySelectorAll('h1, h2');
          headings.forEach(function(heading){
            if(heading.id){
              var container = document.createElement('div');
              var linkContainer = document.createElement('div')
              var link = document.createElement('a');

              container.className = 'article-title';
              linkContainer.className = "permalink";
              link.className = "link-icon";
              link.href = '#'+heading.id;
              link.title = "Permalink to this article";

              linkContainer.appendChild(link);
              heading.insertAdjacentElement("beforebegin", container);
              container.appendChild(heading);
              container.appendChild(linkContainer)
            }
          })
        });
      })();
    </script>
    {{ end }}

</body>

</html>
