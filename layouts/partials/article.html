{{ $roles := .Params.roles | default "All roles" }}
{{ $link := (printf "%v#%v" .Parent.Permalink .Params.Slug ) }}
{{ $type := "parent" }}
{{if not .Data.Pages }}
    {{ $type = "child" }}
{{end}}
{{ $dataId := .Params.id | default .File.Path }}
{{ $pageSlug := (printf "%v-%v" (.Parent.Params.Slug | default "root") .Params.Slug )}}
{{ $nestedArticles := .Site.Params.includeNestedArticles | default true }}

<div class="article {{ $type }}" data-roles="{{ $roles }}" id="{{ $pageSlug }}">
    {{ if or (ne (len .Content) 0) $nestedArticles }}
    <div class="presidium-article-wrapper">
        <span class="anchor"  id="{{ .Params.Slug }}" data-id="{{ $dataId }}"></span>
        <div class="article-title" >
            {{ if not .Data.Pages }}
                <h2>{{ .Title }} {{ partial "edit-link.html" }}</h2>
            {{ else }}
                <h1>{{ .Title }} {{ partial "edit-link.html" }}</h1>
            {{ end }}
           
            <div class="permalink">
                <a class="link-icon" href="#{{ .Params.Slug }}" title="Permalink to this article"></a>
            </div>
        </div>

        {{ partial "article-header" . }}

        <article>{{ .Content }}</article>

        {{ if $nestedArticles }}
            {{ range where .Data.Pages.ByWeight "Params.hidden" "ne" true }}
                {{ partial "article" . }}
            {{ end }}
        {{ end }}

        {{ if not .Data.Pages }}
            <hr>
        {{ end }}
    </div>
    {{ end }}
</div>
